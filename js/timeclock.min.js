function contains(t,d,e){for(var s=0;s<t.length;s++)if(t[s][d]===e)return!0;return!1}function isBetweeen(t,d,e){var s=t.substring(0,2),n=d.substring(0,2),r=e.substring(0,2),a=t.substring(2),i=d.substring(2),u=e.substring(2);return s===n&&n===r&&(a<=i&&i<=u)}function colorize(t,d,e){if(t.substring(0,2)===d.substring(0,2))for(var s,n=t.substring(0,2),r=parseInt(t.substring(2)),a=parseInt(d.substring(2));r<=a;)s=r<10?n+"000"+r:r<100?n+"00"+r:r<1e3?n+"0"+r:n+r,r+=r%100!=0?70:30,$("#"+s).css("background-color",e)}function formatize(t){return t<10?"000"+t:t<100?"00"+t:t<1e3?"0"+t:t}function substractOne(t){var d=t.substring(0,2),e=t;return e=parseInt(e.substring(2)),d+(e=formatize(e-=e%100!=0?30:70))}function addOne(t){var d=t.substring(0,2),e=t;return e=parseInt(e.substring(2)),d+(e=formatize(e+=e%100!=0?70:30))}function isNeighbourOf(t,d){var e=addOne(t.end),s=addOne(d.end);return e===d.start||s===t.start}function isBorderOf(t,d){return!(t.start!==d.start||!isBetweeen(t.start,d.end,t.end))||(!(d.start!==t.start||!isBetweeen(d.start,t.end,d.end))||(!(t.end!==d.end||!isBetweeen(t.start,d.start,t.end))||!(d.end!==t.end||!isBetweeen(d.start,t.start,d.end))))}function overlaps(t,d){return!(!isBetweeen(t.start,d.start,t.end)||isBetweeen(t.start,d.end,t.end))||!(!isBetweeen(d.start,t.start,d.end)||isBetweeen(d.start,t.end,d.end))}Array.prototype.removeValue=function(t,d){var e=$.map(this,function(e,s){return e[t]===d?null:e});this.length=0,this.push.apply(this,e)},$(document).ready(function(){for(var t=$("#timeclock-container"),d=(document.createElement("table"),"<table id='timeclock'><tr><th style='border: none;'></th><th colspan='4'>00:00</th><th colspan='4'>02:00</th><th colspan='4'>04:00</th><th colspan='4'>06:00</th><th colspan='4'>08:00</th><th colspan='4'>10:00</th><th colspan='4'>12:00</th><th colspan='4'>14:00</th><th colspan='4'>16:00</th><th colspan='4'>18:00</th><th colspan='4'>20:00</th><th colspan='4'>22:00</th></tr>"),e=["mo","tu","we","th","fr","sa","su"],s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],n=0;n<e.length;n++)d+='<tr><td class="head">'+s[n]+"</td><td id='"+e[n]+"0000'></td><td id='"+e[n]+"0030'></td><td id='"+e[n]+"0100'></td><td id='"+e[n]+"0130'></td><td id='"+e[n]+"0200'></td><td id='"+e[n]+"0230'></td><td id='"+e[n]+"0300'></td><td id='"+e[n]+"0330'></td><td id='"+e[n]+"0400'></td><td id='"+e[n]+"0430'></td><td id='"+e[n]+"0500'></td><td id='"+e[n]+"0530'></td><td id='"+e[n]+"0600'></td><td id='"+e[n]+"0630'></td><td id='"+e[n]+"0700'></td><td id='"+e[n]+"0730'></td><td id='"+e[n]+"0800'></td><td id='"+e[n]+"0830'></td><td id='"+e[n]+"0900'></td><td id='"+e[n]+"0930'></td><td id='"+e[n]+"1000'></td><td id='"+e[n]+"1030'></td><td id='"+e[n]+"1100'></td><td id='"+e[n]+"1130'></td><td id='"+e[n]+"1200'></td><td id='"+e[n]+"1230'></td><td id='"+e[n]+"1300'></td><td id='"+e[n]+"1330'></td><td id='"+e[n]+"1400'></td><td id='"+e[n]+"1430'></td><td id='"+e[n]+"1500'></td><td id='"+e[n]+"1530'></td><td id='"+e[n]+"1600'></td><td id='"+e[n]+"1630'></td><td id='"+e[n]+"1700'></td><td id='"+e[n]+"1730'></td><td id='"+e[n]+"1800'></td><td id='"+e[n]+"1830'></td><td id='"+e[n]+"1900'></td><td id='"+e[n]+"1930'></td><td id='"+e[n]+"2000'></td><td id='"+e[n]+"2030'></td><td id='"+e[n]+"2100'></td><td id='"+e[n]+"2130'></td><td id='"+e[n]+"2200'></td><td id='"+e[n]+"2230'></td><td id='"+e[n]+"2300'></td><td id='"+e[n]+"2330'></td></tr><tr class='separator'/>";d+="</table>",t.first().after(d);var r,a=[],i=[],u=$("#timeclockInput");if(null===u.val()||""===u.val())r=[];else{r=JSON.parse(u.val()),console.log(JSON.parse(u.val()));for(var o=0;o<r.length;o++)colorize(r[o].start,r[o].end,"lightblue"),r[o].use=!1}$("#timeclock").on("mousedown",function(t){var d,e,s,n;d=t.target.id,$("#"+d).css("background-color","lightgreen"),$("#timeclock").on("mouseup",function(t){if(e=t.target.id,null!==d&&null!==e){s=d.substring(0,2);for(var o=!1,l=0;l<r.length;l++)if(r[l].start.substring(0,2)===s)if(d===r[l].start&&e===r[l].end&&(a.push({start:r[l].start,end:r[l].end}),o=!0),isBetweeen(d,r[l].start,e)&&isBetweeen(d,r[l].end,e))a.push({start:r[l].start,end:r[l].end});else if(isBetweeen(r[l].start,d,r[l].end)&&isBetweeen(r[l].start,e,r[l].end)&&!isBorderOf(r[l],{start:d,end:e})){var h=r[l].start,c=addOne(e),g=substractOne(d),p=r[l].end;a.push({start:r[l].start,end:r[l].end}),o=!0,i.push({start:h,end:g}),i.push({start:c,end:p})}else isNeighbourOf(r[l],{start:d,end:e})?(o=!0,a.push({start:r[l].start,end:r[l].end}),parseInt(r[l].start.substring(2))<parseInt(d.substring(2))?i.push({start:r[l].start,end:e}):parseInt(r[l].start.substring(2))>parseInt(d.substring(2))&&i.push({start:d,end:r[l].end})):isBorderOf(r[l],{start:d,end:e})&&(a.push({start:r[l].start,end:r[l].end}),o=!0,r[l].start===d?i.push({start:addOne(e),end:r[l].end}):r[l].end===e&&i.push({start:r[l].start,end:substractOne(d)}));for(var f=0;f<a.length;f++)colorize(a[f].start,a[f].end,"white"),r.removeValue("start",a[f].start);for(var b=0;b<i.length;b++)if(-1!==i[b]){if(i.length>b+1&&overlaps(i[b+1],i[b])){parseInt(i[b+1].start.substring(2))<parseInt(i[b].start.substring(2))?(colorize(i[b+1].start,i[b].end,"lightgreen"),r.push({start:i[b+1].start,end:i[b].end})):parseInt(i[b+1].start.substring(2))>parseInt(i[b].start.substring(2))&&(colorize(i[b].start,i[b+1].end,"lightgreen"),r.push({start:i[b].start,end:i[b+1].end})),i[b+1]=-1;continue}colorize(i[b].start,i[b].end,"lightgreen"),r.push({start:i[b].start,end:i[b].end})}a=[],i=[],o||d.substring(0,2)===e.substring(0,2)&&(colorize(d,e,"lightgreen"),r.push({start:d,end:e,use:!0}),n=2),e=null,d=null,u.val(JSON.stringify(r))}else n=1}),1===n&&$("#"+d).css("background-color","white")})});